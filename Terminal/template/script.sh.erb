#!/usr/bin/env bash

# benchmark info
echo "TIMING - Starting main script at: $(date)"

# set the TERM
export TERM="xterm-256color"
export TERMINFO=/usr/share/terminfo

# set working directory
cd "$HOME" || exit 7

# benchmark info
echo "TIMING - Starting ttyd at: $(date)"

# launch ttyd
TTYD_PATH=/home/apps/oss/ttyd/`arch`/ttyd-1.7.7/bin/ttyd
$TTYD_PATH \
  -p "${PORT}" \
  -b "/node/${HOST}/${PORT}/${PASSWORD}" \
  -t "fontSize=${OOD_FONT_SIZE}" \
  -t 'cursorStyle=bar' \
  -t 'cursorBlink=true' \
  -t 'theme={"background": "#282a36", "foreground": "#f8f8f2"}' \
  -W -m 1 -w '<%= context.global_working_dir %>'\
  "$OOD_STAGED_ROOT/tmux.sh"
